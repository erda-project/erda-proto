syntax = "proto3";
package erda.core.services.accesskey;
option go_package = "github.com/erda-project/erda-proto-go/core/services/accesskey/pb";

import "google/api/annotations.proto";
import "google/protobuf/timestamp.proto";

service AccessKeyService {
    rpc QueryAccessKeys (QueryAccessKeysRequest) returns (QueryAccessKeysResponse) {
        option (google.api.http) = {
            post: "/api/credential/access-keys/query",
        };
    }

    rpc GetAccessKey (GetAccessKeysRequest) returns (GetAccessKeysResponse) {
        option (google.api.http) = {
            get: "/api/credential/access-keys/{id}",
        };
    }

    rpc CreateAccessKeys (CreateAccessKeysRequest) returns (CreateAccessKeysResponse) {
        option (google.api.http) = {
            post: "/api/credential/access-keys",
        };
    }

    rpc UpdateAccessKeys (UpdateAccessKeysRequest) returns (UpdateAccessKeysResponse) {
        option (google.api.http) = {
            put: "/api/credential/access-keys/{id}",
        };
    }

    rpc DeleteAccessKeys (DeleteAccessKeysRequest) returns (DeleteAccessKeysResponse) {
        option (google.api.http) = {
            delete: "/api/credential/access-keys/{id}",
        };
    }
}

message QueryAccessKeysRequest {
    StatusEnum.Status status = 1;
    SubjectTypeEnum.SubjectType subjectType = 2;
    string subject = 3;
    string accessKey = 4;
}

message QueryAccessKeysResponse {
    repeated AccessKeysItem data = 1;
}

message GetAccessKeysRequest {
    string id = 1;
}
message GetAccessKeysResponse {
    AccessKeysItem data = 1;
}

message CreateAccessKeysRequest {
    SubjectTypeEnum.SubjectType subjectType = 1;
    string subject = 2;
    string description = 3;
}
message CreateAccessKeysResponse {
    AccessKeysItem data = 1;
}

message UpdateAccessKeysRequest {
    string id = 1;
    StatusEnum.Status status = 2;
    string description = 3;
}
message UpdateAccessKeysResponse {}

message DeleteAccessKeysRequest {
    string id = 1;
}
message DeleteAccessKeysResponse {}

message AccessKeysItem {
    string id = 1;
    string accessKey = 2;
    string secretKey = 3;
    StatusEnum.Status status = 4;
    SubjectTypeEnum.SubjectType subjectType = 5;
    string subject = 6;
    string description = 7;
    google.protobuf.Timestamp createdAt = 8;
}

message SubjectTypeEnum {
    enum SubjectType {
        NOT_SPECIFIED = 0; // TODO workaround for optional
        OTHER = 1;
        SYSTEM = 2;
        MICRO_SERVICE = 3;
    }
}
message StatusEnum {
    enum Status {
        NOT_SPECIFIED = 0; // TODO workaround for optional
        ACTIVATE = 1;
        DISABLED = 2;
        DELETED = 3;
    }
}